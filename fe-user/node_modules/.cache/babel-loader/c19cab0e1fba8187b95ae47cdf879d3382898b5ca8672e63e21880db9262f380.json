{"ast":null,"code":"var _jsxFileName = \"D:\\\\0_tai_lieu_mon_hoc\\\\HocLai\\\\PTHTTM\\\\ShoeStore-3012\\\\fe-user\\\\src\\\\contexts\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { cartAPI } from '../services/api';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext(null);\nexport const useCart = () => {\n  _s();\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n_s(useCart, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const CartProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    isAuthenticated\n  } = useAuth();\n  const [cart, setCart] = useState({\n    items: [],\n    totalItems: 0,\n    totalAmount: 0\n  });\n  const [loading, setLoading] = useState(false);\n  const fetchCart = useCallback(async () => {\n    if (!isAuthenticated) {\n      setCart({\n        items: [],\n        totalItems: 0,\n        totalAmount: 0\n      });\n      return;\n    }\n    try {\n      setLoading(true);\n      const response = await cartAPI.get();\n      setCart(response.data.data);\n    } catch (error) {\n      console.error('Fetch cart error:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [isAuthenticated]);\n  useEffect(() => {\n    fetchCart();\n  }, [fetchCart]);\n  const addToCart = async (variantId, quantity = 1) => {\n    if (!isAuthenticated) {\n      throw new Error('Vui lòng đăng nhập để thêm vào giỏ hàng');\n    }\n    try {\n      await cartAPI.addItem({\n        variantId,\n        quantity\n      });\n      await fetchCart();\n      return true;\n    } catch (error) {\n      throw error;\n    }\n  };\n  const updateQuantity = async (itemId, quantity) => {\n    try {\n      await cartAPI.updateItem(itemId, {\n        quantity\n      });\n      await fetchCart();\n      return true;\n    } catch (error) {\n      throw error;\n    }\n  };\n  const removeItem = async itemId => {\n    try {\n      await cartAPI.removeItem(itemId);\n      await fetchCart();\n      return true;\n    } catch (error) {\n      throw error;\n    }\n  };\n  const clearCart = async () => {\n    try {\n      await cartAPI.clear();\n      setCart({\n        items: [],\n        totalItems: 0,\n        totalAmount: 0\n      });\n      return true;\n    } catch (error) {\n      throw error;\n    }\n  };\n  const getCartCount = async () => {\n    if (!isAuthenticated) return 0;\n    try {\n      const response = await cartAPI.getCount();\n      return response.data.data.count;\n    } catch (error) {\n      return 0;\n    }\n  };\n  const value = {\n    cart,\n    loading,\n    fetchCart,\n    addToCart,\n    updateQuantity,\n    removeItem,\n    clearCart,\n    getCartCount\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 9\n  }, this);\n};\n_s2(CartProvider, \"VNdK3rj7jOz/p+o06bisE4aGtf4=\", false, function () {\n  return [useAuth];\n});\n_c = CartProvider;\nexport default CartContext;\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","cartAPI","useAuth","jsxDEV","_jsxDEV","CartContext","useCart","_s","context","Error","CartProvider","children","_s2","isAuthenticated","cart","setCart","items","totalItems","totalAmount","loading","setLoading","fetchCart","response","get","data","error","console","addToCart","variantId","quantity","addItem","updateQuantity","itemId","updateItem","removeItem","clearCart","clear","getCartCount","getCount","count","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/0_tai_lieu_mon_hoc/HocLai/PTHTTM/ShoeStore-3012/fe-user/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { cartAPI } from '../services/api';\nimport { useAuth } from './AuthContext';\n\nconst CartContext = createContext(null);\n\nexport const useCart = () => {\n    const context = useContext(CartContext);\n    if (!context) {\n        throw new Error('useCart must be used within a CartProvider');\n    }\n    return context;\n};\n\nexport const CartProvider = ({ children }) => {\n    const { isAuthenticated } = useAuth();\n    const [cart, setCart] = useState({\n        items: [],\n        totalItems: 0,\n        totalAmount: 0\n    });\n    const [loading, setLoading] = useState(false);\n\n    const fetchCart = useCallback(async () => {\n        if (!isAuthenticated) {\n            setCart({ items: [], totalItems: 0, totalAmount: 0 });\n            return;\n        }\n\n        try {\n            setLoading(true);\n            const response = await cartAPI.get();\n            setCart(response.data.data);\n        } catch (error) {\n            console.error('Fetch cart error:', error);\n        } finally {\n            setLoading(false);\n        }\n    }, [isAuthenticated]);\n\n    useEffect(() => {\n        fetchCart();\n    }, [fetchCart]);\n\n    const addToCart = async (variantId, quantity = 1) => {\n        if (!isAuthenticated) {\n            throw new Error('Vui lòng đăng nhập để thêm vào giỏ hàng');\n        }\n\n        try {\n            await cartAPI.addItem({ variantId, quantity });\n            await fetchCart();\n            return true;\n        } catch (error) {\n            throw error;\n        }\n    };\n\n    const updateQuantity = async (itemId, quantity) => {\n        try {\n            await cartAPI.updateItem(itemId, { quantity });\n            await fetchCart();\n            return true;\n        } catch (error) {\n            throw error;\n        }\n    };\n\n    const removeItem = async (itemId) => {\n        try {\n            await cartAPI.removeItem(itemId);\n            await fetchCart();\n            return true;\n        } catch (error) {\n            throw error;\n        }\n    };\n\n    const clearCart = async () => {\n        try {\n            await cartAPI.clear();\n            setCart({ items: [], totalItems: 0, totalAmount: 0 });\n            return true;\n        } catch (error) {\n            throw error;\n        }\n    };\n\n    const getCartCount = async () => {\n        if (!isAuthenticated) return 0;\n        \n        try {\n            const response = await cartAPI.getCount();\n            return response.data.data.count;\n        } catch (error) {\n            return 0;\n        }\n    };\n\n    const value = {\n        cart,\n        loading,\n        fetchCart,\n        addToCart,\n        updateQuantity,\n        removeItem,\n        clearCart,\n        getCartCount\n    };\n\n    return (\n        <CartContext.Provider value={value}>\n            {children}\n        </CartContext.Provider>\n    );\n};\n\nexport default CartContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}